<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Turn Script-Based Workflows into Reproducible Pipelines • bakepipe</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Turn Script-Based Workflows into Reproducible Pipelines">
<meta name="description" content="Turn script-based workflows into reproducible pipelines. Designed for scientists and analysts who use R and prefer to keep their workflows in scripts, but need better management of file dependencies. The package automatically determines script execution order through static analysis of file_in() and file_out() calls.">
<meta property="og:description" content="Turn script-based workflows into reproducible pipelines. Designed for scientists and analysts who use R and prefer to keep their workflows in scripts, but need better management of file dependencies. The package automatically determines script execution order through static analysis of file_in() and file_out() calls.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">bakepipe</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vangberg/bakepipe/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="bakepipe">Bakepipe<a class="anchor" aria-label="anchor" href="#bakepipe"></a>
</h1></div>
<p>Bakepipe is an R library that turns your script-based workflows into reproducible pipelines. It’s designed for scientists and analysts who use R and prefer to keep their workflows in scripts, but need better management of file dependencies.</p>
<p><strong>Key features:</strong></p>
<ul>
<li>
<strong>Automatic dependency detection</strong> - determines script execution order from <code><a href="reference/file_in.html">file_in()</a></code> and <code><a href="reference/file_out.html">file_out()</a></code> calls</li>
<li>
<strong>Incremental execution</strong> - only re-runs scripts when they or their dependencies change</li>
<li>
<strong>Script-based workflow</strong> - no need to refactor existing code into functions</li>
</ul>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ul>
<li><a href="#motivation">Motivation</a></li>
<li>
<a href="#quick-start">Quick Start</a>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#your-first-pipeline">Your First Pipeline</a></li>
</ul>
</li>
<li><a href="#example">Example</a></li>
<li>
<a href="#api">API</a>
<ul>
<li><a href="#mark-external-input">Mark external input</a></li>
<li><a href="#mark-internal-input">Mark internal input</a></li>
<li><a href="#mark-output">Mark output</a></li>
<li><a href="#run-pipeline">Run pipeline</a></li>
<li><a href="#show-pipeline-status">Show pipeline status</a></li>
</ul>
</li>
<li>
<a href="#frequently-asked-questions">Frequently asked questions</a>
<ul>
<li><a href="#how-is-script-execution-order-determined">How is script execution order determined?</a></li>
<li><a href="#are-outputs-cached">Are outputs cached?</a></li>
<li><a href="#how-does-bakepipe-compare-to-other-pipeline-tools">How does Bakepipe compare to other pipeline tools?</a></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>When analyzing data in R, you often start with everything in a single script. As the analysis broadens, you might split it into multiple scripts. One script might read in the data, clean it up, maybe merge multiple datasets. Statistics are run in another script, while plots are generated in a third. Each script writes data to be used by another script. This is all fine, but eventually it gets out of hand. You need to manually run the scripts in the right order, manually tracking these file dependencies. This manual tracking can lead to errors, forgotten steps, and headaches, especially when sharing your analysis with colleagues.</p>
<p>Bakepipe helps you manage this by automatically determining the execution order of your scripts based on their file inputs and outputs. It lets you maintain your script-based workflow, avoiding the need to refactor into functions or learn complex new syntaxes.</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub using devtools</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"vangberg/bakepipe"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="your-first-pipeline">Your First Pipeline<a class="anchor" aria-label="anchor" href="#your-first-pipeline"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Create project root marker:</strong> Create an empty <code>_bakepipe.R</code> file in your project root directory.</li>
<li>
<strong>Mark file relationships:</strong> In your R scripts, use <code><a href="reference/external_in.html">external_in()</a></code> for external files, <code><a href="reference/file_in.html">file_in()</a></code> for pipeline-internal files, and <code><a href="reference/file_out.html">file_out()</a></code> to specify output files.</li>
<li>
<strong>Run:</strong> From your R console or RStudio, simply call <code><a href="reference/run.html">bakepipe::run()</a></code>.</li>
</ol>
<p>Bakepipe will detect these file relationships and execute all your scripts in the correct order. On subsequent runs, only scripts with changes or stale dependencies will be re-executed, making your pipeline runs much faster.</p>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In our example, we have the following files:</p>
<table class="table">
<thead><tr class="header">
<th>File</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>sales.csv</code></td>
<td>Daily sales data with product categories and revenue</td>
</tr>
<tr class="even">
<td><code>analysis.R</code></td>
<td>Calculates monthly sales summaries</td>
</tr>
<tr class="odd">
<td><code>plots.R</code></td>
<td>Creates a monthly trend plot</td>
</tr>
<tr class="even">
<td><code>report.R</code></td>
<td>Generates a PDF report from the monthly data</td>
</tr>
</tbody>
</table>
<p>The workflow looks like this:</p>
<pre class="mermaid"><code>graph LR
    data[(sales.csv)] --&gt;|read by| analysis[analysis.R]
    analysis --&gt;|writes| results[(monthly_sales.csv)]
    results --&gt;|read by| plots[plots.R]
    results --&gt;|read by| report[report.R]
    plots --&gt;|writes| plot{{monthly_trend.png}}
    report --&gt;|writes| pdf{{sales_report.pdf}}</code></pre>
<p>Here is what the scripts look like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analysis.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vangberg.github.io/bakepipe/">bakepipe</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="reference/external_in.html">external_in</a></span><span class="op">(</span><span class="st">"sales.csv"</span><span class="op">)</span><span class="op">)</span> <span class="co"># External input file</span></span>
<span><span class="va">monthly</span> <span class="op">&lt;-</span> <span class="va">sales</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">month</span>, <span class="va">category</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>revenue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">revenue</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">monthly</span>, <span class="fu"><a href="reference/file_out.html">file_out</a></span><span class="op">(</span><span class="st">"monthly_sales.csv"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Output file</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plots.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vangberg.github.io/bakepipe/">bakepipe</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="reference/file_in.html">file_in</a></span><span class="op">(</span><span class="st">"monthly_sales.csv"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Input file</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">monthly</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">month</span>, <span class="va">revenue</span>, color <span class="op">=</span> <span class="va">category</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggsave</span><span class="op">(</span><span class="fu"><a href="reference/file_out.html">file_out</a></span><span class="op">(</span><span class="st">"monthly_trend.png"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Output file</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># report.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vangberg.github.io/bakepipe/">bakepipe</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="reference/file_in.html">file_in</a></span><span class="op">(</span><span class="st">"monthly_sales.csv"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Input file</span></span>
<span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"report_template.Rmd"</span>, </span>
<span>       output_file <span class="op">=</span> <span class="fu"><a href="reference/file_out.html">file_out</a></span><span class="op">(</span><span class="st">"sales_report.pdf"</span><span class="op">)</span>,</span>
<span>       params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">monthly</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><code>external_in</code>, <code>file_in</code> and <code>file_out</code> are used to mark the input and output of the script. They all return the path to the file, so they can be used directly when reading or writing. They don’t actually read or write files themselves – they just mark file relationships so Bakepipe can figure out what needs to run when. This works seamlessly with any R data type or file format (e.g., <code>.csv</code>, <code>.rds</code>, <code>.fst</code>).</p>
<p>To execute your pipeline:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bakepipe</span><span class="fu">::</span><span class="fu"><a href="reference/run.html">run</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will execute all your scripts in the right order every time it’s called, and tell you which files were created.</p>
</div>
<div class="section level2">
<h2 id="api">API<a class="anchor" aria-label="anchor" href="#api"></a>
</h2>
<div class="section level3">
<h3 id="mark-external-input">Mark external input<a class="anchor" aria-label="anchor" href="#mark-external-input"></a>
</h3>
<p>To mark a file as external input that is provided by the user (not produced by any script in the pipeline), use <code>bakepipe::external_in("path/to/file")</code>. <code>external_in(path)</code> returns <code>path</code>, so it can be used directly when reading the file:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">bakepipe</span><span class="fu">::</span><span class="fu"><a href="reference/external_in.html">external_in</a></span><span class="op">(</span><span class="st">"raw_data.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">bakepipe</span><span class="fu">::</span><span class="fu"><a href="reference/external_in.html">external_in</a></span><span class="op">(</span><span class="st">"config.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Use <code><a href="reference/external_in.html">external_in()</a></code> for files like raw datasets, configuration files, or any input that exists outside your pipeline’s processing workflow.</p>
</div>
<div class="section level3">
<h3 id="mark-internal-input">Mark internal input<a class="anchor" aria-label="anchor" href="#mark-internal-input"></a>
</h3>
<p>To mark a file as input that is produced by another script in the pipeline, use <code>bakepipe::file_in("path/to/file")</code>. <code>file_in(path)</code> returns <code>path</code>, so it can be used directly when reading the file:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">bakepipe</span><span class="fu">::</span><span class="fu"><a href="reference/file_in.html">file_in</a></span><span class="op">(</span><span class="st">"data.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mark-output">Mark output<a class="anchor" aria-label="anchor" href="#mark-output"></a>
</h3>
<p>To mark a file as output, use <code>bakepipe::file_out("path/to/file")</code>. <code>file_out(path)</code> returns <code>path</code>, so it can be used directly when writing the file:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">bakepipe</span><span class="fu">::</span><span class="fu"><a href="reference/file_out.html">file_out</a></span><span class="op">(</span><span class="st">"data.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-pipeline">Run pipeline<a class="anchor" aria-label="anchor" href="#run-pipeline"></a>
</h3>
<p>To run the pipeline, use <code><a href="reference/run.html">bakepipe::run()</a></code>. This will execute all scripts in the pipeline graph in their determined topological order, and return a list of the files that were created or updated. If a script fails, Bakepipe stops execution and provides R’s standard error messages, allowing for easy debugging.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bakepipe</span><span class="fu">::</span><span class="fu"><a href="reference/run.html">run</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="show-pipeline-status">Show pipeline status<a class="anchor" aria-label="anchor" href="#show-pipeline-status"></a>
</h3>
<p>To show the pipeline, use <code><a href="reference/status.html">bakepipe::status()</a></code>. This will display a textual representation of the input/output relationships between your files in the console, helping you visualize your workflow.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bakepipe</span><span class="fu">::</span><span class="fu"><a href="reference/status.html">status</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="frequently-asked-questions">Frequently asked questions<a class="anchor" aria-label="anchor" href="#frequently-asked-questions"></a>
</h2>
<div class="section level3">
<h3 id="how-is-script-execution-order-determined">How is script execution order determined?<a class="anchor" aria-label="anchor" href="#how-is-script-execution-order-determined"></a>
</h3>
<p>Bakepipe determines the correct execution order through static analysis of your R scripts, looking for <code>external_in</code>, <code>file_in</code> and <code>file_out</code> calls. It parses the scripts without executing them to build an execution graph, which it then uses to determine the proper sequence. This static analysis means you don’t need to refactor your scripts into functions or drastically change your script structure beyond adding the <code><a href="reference/external_in.html">external_in()</a></code>, <code><a href="reference/file_in.html">file_in()</a></code> and <code><a href="reference/file_out.html">file_out()</a></code> calls.</p>
</div>
<div class="section level3">
<h3 id="are-outputs-cached">Are outputs cached?<a class="anchor" aria-label="anchor" href="#are-outputs-cached"></a>
</h3>
<p>Yes! Bakepipe automatically performs incremental execution by tracking file checksums in a <code>.bakepipe.state</code> file. After the first run, Bakepipe will only re-run scripts that are “stale” - meaning either:</p>
<ul>
<li>The script itself has been modified</li>
<li>Any of the script’s input files have been modified</li>
<li>Any upstream dependencies have been modified</li>
</ul>
<p>This makes subsequent runs much faster, as only the necessary scripts are executed. Fresh scripts are skipped with a visual indicator showing they’re up to date.</p>
</div>
<div class="section level3">
<h3 id="how-does-bakepipe-compare-to-other-pipeline-tools">How does Bakepipe compare to other pipeline tools?<a class="anchor" aria-label="anchor" href="#how-does-bakepipe-compare-to-other-pipeline-tools"></a>
</h3>
<p>I want to preface this comparison by saying that Bakepipe is much more limited in scope than other pipeline tools. It’s not a replacement for tools like Snakemake or Nextflow, but rather a tool for simple workflows that don’t need the complexity of those tools. Yet, I want to highlight some of the features that make Bakepipe unique.</p>
<div class="section level4">
<h4 id="snakemake">Snakemake<a class="anchor" aria-label="anchor" href="#snakemake"></a>
</h4>
<p>With Snakemake, you would define the workflow from the walkthrough above as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">rule all</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="at">    </span><span class="fu">input</span><span class="kw">:</span><span class="at"> </span><span class="st">"monthly_trend.png"</span><span class="er">,</span><span class="at"> </span><span class="er">"sales_report.pdf"</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">rule analysis</span><span class="kw">:</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="at">    </span><span class="fu">input</span><span class="kw">:</span><span class="at"> </span><span class="st">"sales.csv"</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="at">    </span><span class="fu">output</span><span class="kw">:</span><span class="at"> </span><span class="st">"monthly_sales.csv"</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="at">    </span><span class="fu">shell</span><span class="kw">:</span><span class="at"> </span><span class="st">"Rscript analysis.R"</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">rule plots</span><span class="kw">:</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="at">    </span><span class="fu">input</span><span class="kw">:</span><span class="at"> </span><span class="st">"monthly_sales.csv"</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="at">    </span><span class="fu">output</span><span class="kw">:</span><span class="at"> </span><span class="st">"monthly_trend.png"</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="at">    </span><span class="fu">shell</span><span class="kw">:</span><span class="at"> </span><span class="st">"Rscript plots.R"</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">rule report</span><span class="kw">:</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="at">    </span><span class="fu">input</span><span class="kw">:</span><span class="at"> </span><span class="st">"monthly_sales.csv"</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="at">    </span><span class="fu">output</span><span class="kw">:</span><span class="at"> </span><span class="st">"sales_report.pdf"</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="at">    </span><span class="fu">shell</span><span class="kw">:</span><span class="at"> </span><span class="st">"Rscript report.R"</span></span></code></pre></div>
<p>And to run the pipeline, you would use the following command:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">snakemake</span></span></code></pre></div>
<p>Compared with Bakepipe, I think this adds friction. You need to do double bookkeeping, manually keeping the Snakefile and the scripts in sync.</p>
</div>
<div class="section level4">
<h4 id="targets">targets<a class="anchor" aria-label="anchor" href="#targets"></a>
</h4>
<p>To implement the same workflow in <a href="https://docs.ropensci.org/targets/" class="external-link">targets</a>, you would need to refactor the scripts into functions, and then use the <code>tar_target</code> function to define the targets.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># functions.R</span></span>
<span></span>
<span><span class="va">get_sales_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">analyze_sales</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">group_by</span><span class="op">(</span><span class="va">month</span>, <span class="va">category</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">summarize</span><span class="op">(</span>revenue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">revenue</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">create_trend_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">month</span>, <span class="va">revenue</span>, color <span class="op">=</span> <span class="va">category</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu">ggsave</span><span class="op">(</span><span class="st">"monthly_trend.png"</span>, <span class="va">plot</span><span class="op">)</span></span>
<span>    <span class="st">"monthly_trend.png"</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">generate_report</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"report_template.Rmd"</span>, </span>
<span>           output_file <span class="op">=</span> <span class="st">"sales_report.pdf"</span>,</span>
<span>           params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="st">"sales_report.pdf"</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># _targets.R</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/" class="external-link">targets</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tar_source</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">tar_target</span><span class="op">(</span><span class="va">sales_file</span>, <span class="st">"sales.csv"</span>, format <span class="op">=</span> <span class="st">"file"</span><span class="op">)</span>,</span>
<span>    <span class="fu">tar_target</span><span class="op">(</span><span class="va">sales_data</span>, <span class="fu">get_sales_data</span><span class="op">(</span><span class="va">sales_file</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">tar_target</span><span class="op">(</span><span class="va">monthly_sales</span>, <span class="fu">analyze_sales</span><span class="op">(</span><span class="va">sales_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">tar_target</span><span class="op">(</span><span class="va">trend_plot</span>, <span class="fu">create_trend_plot</span><span class="op">(</span><span class="va">monthly_sales</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"file"</span><span class="op">)</span>,</span>
<span>    <span class="fu">tar_target</span><span class="op">(</span><span class="va">report_pdf</span>, <span class="fu">generate_report</span><span class="op">(</span><span class="va">monthly_sales</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"file"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In other words, to use <code>targets</code>, you need to abandon your script-based workflow and start writing functions. This in itself is not really a big change; worst case you could just wrap each script in a function. But in the process, you lose some of the advantages of a script-based workflow, namely the iterative and interactive development that R users often rely on, which makes e.g. debugging more difficult, something the <a href="https://books.ropensci.org/targets/debugging.html" class="external-link">targets package acknowledges</a>.</p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/vangberg/bakepipe/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/vangberg/bakepipe/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing bakepipe</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://harry.vangberg.name" class="external-link">Harry Vangberg</a> <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://harry.vangberg.name" class="external-link">Harry Vangberg</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
